<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>자기소개 | Portfolio</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header class="topbar">
    <nav class="nav">
      <div class="nav-links">
        <a class="btn-outline" href="index.html">리스트</a>
        <a class="btn-outline" href="intro.html" aria-current="page">소개</a>
      </div>
      <!-- 소개 페이지는 옵션 미노출 -->
    </nav>
  </header>

  <main id="content" class="intro-container">
    <!-- 히어로 카드 -->
    <section class="card intro-hero" aria-label="프로필">
      <div class="intro-hero-body">
        <div class="intro-avatar" aria-hidden="true">
          <img src="./images/" alt="">
        </div>
        <div class="intro-head">
          <h1 class="intro-title">안녕하세요</h1>
          <p class="intro-sub">김효준입니다.</p>
        </div>
      </div>
    </section>

    <!-- 카드 그리드 -->
    <section class="intro-grid">
      <!-- 자기소개 카드: about.md 로딩 -->
      <article class="card" aria-labelledby="about-title">
        <div class="card-section">
          <h2 id="about-title">자기소개</h2>
          <div id="about-content" role="region" aria-live="polite">
            <p>잠시만 기다려 주세요...</p>
          </div>
        </div>
      </article>

      <!-- 링크 카드 -->
      <article class="card" aria-labelledby="links-title">
        <div class="card-section">
          <h2 id="links-title">링크</h2>
          <div class="link-cards intro-links">
            <a href="https://github.com/emiteat" target="_blank" rel="noopener">
              <span class="link-thumb"><img src="https://avatars.githubusercontent.com/emiteat" alt=""></span>
              <span class="link-meta">
                <span class="link-title">GitHub</span>
                <span class="link-domain">emiteat</span>
              </span>
            </a>
            <a href="https://discord.gg/" target="_blank" rel="noopener">
              <span class="link-thumb"><img src="https://www.google.com/s2/favicons?domain=discord.gg&sz=64" alt=""></span>
              <span class="link-meta">
                <span class="link-title">Discord</span>
                <span class="link-domain">tea_time__</span>
              </span>
            </a>
            <a href="mailto:sdh250209@sdh.hs.kr">
              <span class="link-thumb"><img src="https://www.google.com/s2/favicons?domain=sdh.hs.kr&sz=64" alt=""></span>
              <span class="link-meta">
                <span class="link-title">Email</span>
                <span class="link-domain">sdh.hs.kr</span>
              </span>
            </a>
          </div>
        </div>
      </article>

      <!-- 스킬 카드(카테고리별) -->
      <article class="card" aria-labelledby="skills-title">
        <div class="card-section">
          <h2 id="skills-title">기술 스택</h2>
          <div class="stack-grid">
            <section class="stack-group" aria-labelledby="stack-lang">
              <h3 id="stack-lang">언어</h3>
              <div class="tag-list">
                <span class="tag">JavaScript</span>
                <span class="tag">HTML/CSS</span>
                <span class="tag">C</span>
                <span class="tag">C++</span>
                <span class="tag">C#</span>
                <span class="tag">Java</span>
              </div>
            </section>

            <section class="stack-group" aria-labelledby="stack-fw">
              <h3 id="stack-fw">프레임워크/런타임</h3>
              <div class="tag-list">
                <span class="tag">Node.js</span>
              </div>
            </section>

            <section class="stack-group" aria-labelledby="stack-engine">
              <h3 id="stack-engine">엔진</h3>
              <div class="tag-list">
                <span class="tag">Unity Engine</span>
                <span class="tag">Unreal Engine</span>
              </div>
            </section>

            <section class="stack-group" aria-labelledby="stack-db">
              <h3 id="stack-db">데이터베이스</h3>
              <div class="tag-list">
                <span class="tag">MongoDB</span>
              </div>
            </section>
          </div>
        </div>
      </article>

      <!-- 기타 카드(자유 편집) -->
      <article class="card" aria-labelledby="etc-title">
        <div class="card-section">
          <h2 id="etc-title">기타</h2>
          <p>진행 중인 작업, 공지, 연락 가능 시간 등 원하는 내용을 넣어 주세요.</p>
        </div>
      </article>
    </section>
  </main>

  <footer class="footer">
    <small>&copy; 2025 Portfolio</small>
  </footer>

  <script>
    // asset/about.md를 불러와 간단한 마크다운 렌더링
    (function () {
      const src = 'asset/about.md';
      const container = document.getElementById('about-content');

      function escapeHTML(s) {
        return String(s||'')
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;');
      }
      function linkify(text) {
        return text.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" rel="noopener">$1</a>');
      }
      function markdownToHtml(md) {
        const lines = md.replace(/\r\n?/g, '\n').split('\n');
        const out = []; let inList = false; let para = [];
        function flushPara(){ if(para.length){ out.push('<p>'+linkify(escapeHTML(para.join(' ')))+'</p>'); para=[]; } }
        function closeList(){ if(inList){ out.push('</ul>'); inList=false; } }
        for (let raw of lines) {
          const line = raw.trimEnd();
          if (!line.trim()){ flushPara(); closeList(); continue; }
          if (line.startsWith('### ')){ flushPara(); closeList(); out.push('<h3>'+linkify(escapeHTML(line.slice(4)))+'</h3>'); continue; }
          if (line.startsWith('## ')){ flushPara(); closeList(); out.push('<h2>'+linkify(escapeHTML(line.slice(3)))+'</h2>'); continue; }
          if (line.startsWith('# ')){  flushPara(); closeList(); out.push('<h1>'+linkify(escapeHTML(line.slice(2)))+'</h1>'); continue; }
          if (/^[-*]\s+/.test(line)){
            flushPara(); if(!inList){ out.push('<ul>'); inList=true; }
            out.push('<li>'+linkify(escapeHTML(line.replace(/^[-*]\s+/, '')))+'</li>'); continue;
          }
          para.push(line);
        }
        flushPara(); closeList();
        return out.join('\n');
      }
      async function init() {
        try {
          const res = await fetch(src, { cache: 'no-store' });
          if (!res.ok) throw new Error('Failed to load about.md');
          const md = await res.text();
          container.innerHTML = markdownToHtml(md);
        } catch (err) {
          container.innerHTML = '<p>자기소개를 불러오지 못했습니다. <a href="' + src + '">about.md 보기</a></p>';
          console.error(err);
        }
      }
      document.addEventListener('DOMContentLoaded', init);
    })();
  </script>

  <!-- 링크 → 썸네일 카드 자동 변환 -->
  <script>
    (function(){
      const wrap = document.querySelector('.intro-links');
      if(!wrap) return;

      // 도우미
      const emailRe = /^[^@\s]+@[^@\s]+\.[^@\s]+$/;
      function escapeHtml(s){
        return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
      }
      function normalizeHref(href){
        href = String(href||'').trim();
        if (!href) return '';
        if (emailRe.test(href)) return 'mailto:' + href;
        if (/^mailto:/i.test(href)) return href;
        if (/^(https?:)?\/\//i.test(href)) return href.startsWith('//') ? 'https:' + href : href;
        if (/^([a-z0-9-]+\.)+[a-z]{2,}([/:].*)?$/i.test(href)
          || /^discord\.gg\//i.test(href)
          || /^discord\.com\//i.test(href)
          || /^github\.com\//i.test(href)
          || /^x\.com\//i.test(href)
          || /^youtube\.com\//i.test(href)
          || /^youtu\.be\//i.test(href)
          || /^notion\.so\//i.test(href)) {
          return 'https://' + href;
        }
        return href; // 상대경로는 그대로
      }

      // 카드 변환
      const links = Array.from(wrap.querySelectorAll('a'));
      wrap.classList.add('link-cards');
      links.forEach(a=>{
        const rawHref = a.getAttribute('href') || a.textContent;
        const href = normalizeHref(rawHref);
        a.setAttribute('href', href);

        let u;
        try{ u = new URL(href, location.origin); }catch{ u = null; }
        const domain = u ? u.hostname.replace(/^www\./,'') : '';
        const title = a.textContent.trim() || (u ? domain : href);

        // 썸네일 추정
        let thumb = '';
        if (u && domain==='github.com'){
          const user = u.pathname.split('/').filter(Boolean)[0];
          if (user) thumb = `https://avatars.githubusercontent.com/${user}`;
        }
        // favicon을 기본 썸네일로 활용(가벼움)
        const favicon = u ? `https://www.google.com/s2/favicons?domain=${u.hostname}&sz=64` : '';

        a.classList.remove('btn-chip');
        a.classList.add('link-card');
        a.setAttribute('target', '_blank');
        a.setAttribute('rel', 'noopener');

        a.innerHTML = `
          <span class="link-thumb">${thumb ? `<img src="${thumb}" alt="">` : (favicon ? `<img src="${favicon}" alt="">` : '')}</span>
          <span class="link-meta">
            <span class="link-title">${escapeHtml(title)}</span>
            <span class="link-domain">${escapeHtml(domain || href)}</span>
          </span>`;
      });
    })();
  </script>
</body>
</html>